DEBUG=NODEBUG
DEBUGD=-D$(DEBUG)
CFLAGS= -O3 -g $(DEBUGD) -I../lib
FFLAGS= -O3 -g
LIBS_SOCKET  = -g -L../lib -lldcs_socket
LIBS_PIPE    = -g -L../lib -lldcs_pipe

MPICC = mpicc
CC       = /bgsys/drivers/ppcfloor/gnu-linux/bin/powerpc64-bgq-linux-gcc -m64
MPICC     = mpicc

ifeq ($(DEBUG),SIONDEBUG)
 CFLAGS      += -I../tools/sion_debug
 LIBS_SOCKET += -L../tools/sion_debug -lsiondebug
 LIBS_PIPE   += -L../tools/sion_debug -lsiondebug
endif

all: default 

default: ldcs_simple_client_socket ldcs_simple_client_pipe ldcs_simple_client_pipe_mpi

ldcs_simple_client_socket:   ldcs_simple_client.o
	 $(CC) $(CFLAGS) -o ldcs_simple_client_socket ldcs_simple_client.o $(LIBS_SOCKET) 

ldcs_simple_client_pipe:   ldcs_simple_client.o
	 $(CC) $(CFLAGS) -o ldcs_simple_client_pipe ldcs_simple_client.o $(LIBS_PIPE) 

ldcs_simple_client.o: 	ldcs_simple_client.c Makefile  ../lib/libldcs_socket.a ../lib/libldcs_pipe.a
	$(CC) $(CFLAGS) -c  ldcs_simple_client.c	


ldcs_simple_client_pipe_mpi:   ldcs_simple_client_mpi.o
	 $(MPICC) $(CFLAGS) -o ldcs_simple_client_pipe_mpi ldcs_simple_client_mpi.o $(LIBS_PIPE) 

ldcs_simple_client_mpi.o: 	ldcs_simple_client_mpi.c Makefile  ../lib/libldcs_socket.a ../lib/libldcs_pipe.a
	$(MPICC) $(CFLAGS) -c  ldcs_simple_client_mpi.c	

clean::
	rm -rf *.o  *~ *core*
	rm -rf ldcs_simple_client ldcs_simple_client_pipe ldcs_simple_client_pipe_mpi ldcs_simple_client_socket

